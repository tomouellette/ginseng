
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Efficient and accurate annotation for single-cell sequencing data">
      
      
        <meta name="author" content="Tom W. Ouellette">
      
      
      
        <link rel="prev" href="../guides/uterine/">
      
      
      
        
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="zensical-0.0.5">
    
    
      
        <title>API Reference - ginseng</title>
      
    
    
      
        
      
      <link rel="stylesheet" href="../assets/stylesheets/modern/main.1357c24d.min.css">
      
        
          
        
        <link rel="stylesheet" href="../assets/stylesheets/modern/palette.dfe2e883.min.css">
      
      
  
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
  
  <style>:root{}</style>



    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Inter:300,300i,400,400i,500,500i,700,700i%7CJetBrains+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Inter";--md-code-font:"JetBrains Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../stylesheets/extra.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#api-reference" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="ginseng" class="md-header__button md-logo" aria-label="ginseng" data-md-component="logo">
      
  <img src="../assets/logo.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" class="lucide lucide-menu" viewBox="0 0 24 24"><path d="M4 5h16M4 12h16M4 19h16"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            ginseng
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              API Reference
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="none" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" class="lucide lucide-sun" viewBox="0 0 24 24"><circle cx="12" cy="12" r="4"/><path d="M12 2v2M12 20v2M4.93 4.93l1.41 1.41M17.66 17.66l1.41 1.41M2 12h2M20 12h2M6.34 17.66l-1.41 1.41M19.07 4.93l-1.41 1.41"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="none" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" class="lucide lucide-moon" viewBox="0 0 24 24"><path d="M20.985 12.486a9 9 0 1 1-9.473-9.472c.405-.022.617.46.402.803a6 6 0 0 0 8.268 8.268c.344-.215.825-.004.803.401"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" class="lucide lucide-search" viewBox="0 0 24 24"><path d="m21 21-4.34-4.34"/><circle cx="11" cy="11" r="8"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog" aria-label="Search">
  <button type="button" class="md-search__button">
    Search
  </button>
</div>
      
    
    <div class="md-header__source">
      
        <a href="https://github.com/tomouellette/ginseng" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      
    </div>
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="ginseng" class="md-nav__button md-logo" aria-label="ginseng" data-md-component="logo">
      
  <img src="../assets/logo.svg" alt="logo">

    </a>
    ginseng
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/tomouellette/ginseng" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Get started
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Guides
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Guides
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../guides/basic/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Basic usage
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../guides/uterine/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Training a model to annotate new data
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    API
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    API
  

    
  </span>
  
  

      </a>
      
        


<nav class="md-nav md-nav--secondary" aria-label="On this page">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      On this page
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#table-of-contents" class="md-nav__link">
    <span class="md-ellipsis">
      
        Table of Contents
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#file-datadatasetpy" class="md-nav__link">
    <span class="md-ellipsis">
      
        File: data/dataset.py
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="File: data&#x2f;dataset.py">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#class-ginsengdataset" class="md-nav__link">
    <span class="md-ellipsis">
      
        Class GinsengDataset
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Class GinsengDataset">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#method-_load_metadata" class="md-nav__link">
    <span class="md-ellipsis">
      
        Method _load_metadata
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#method-create" class="md-nav__link">
    <span class="md-ellipsis">
      
        Method create
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#method-make_split" class="md-nav__link">
    <span class="md-ellipsis">
      
        Method make_split
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#method-stream" class="md-nav__link">
    <span class="md-ellipsis">
      
        Method stream
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#file-dataiopy" class="md-nav__link">
    <span class="md-ellipsis">
      
        File: data/io.py
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="File: data&#x2f;io.py">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#function-read_10x_mtx" class="md-nav__link">
    <span class="md-ellipsis">
      
        Function read_10x_mtx
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#function-read_10x_h5" class="md-nav__link">
    <span class="md-ellipsis">
      
        Function read_10x_h5
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#function-read_adata" class="md-nav__link">
    <span class="md-ellipsis">
      
        Function read_adata
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#function-_load_pytree" class="md-nav__link">
    <span class="md-ellipsis">
      
        Function _load_pytree
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#function-save_model" class="md-nav__link">
    <span class="md-ellipsis">
      
        Function save_model
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#function-_save_pytree" class="md-nav__link">
    <span class="md-ellipsis">
      
        Function _save_pytree
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#function-load_model" class="md-nav__link">
    <span class="md-ellipsis">
      
        Function load_model
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#file-modelnnpy" class="md-nav__link">
    <span class="md-ellipsis">
      
        File: model/nn.py
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="File: model&#x2f;nn.py">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#class-ginsengclassifier" class="md-nav__link">
    <span class="md-ellipsis">
      
        Class GinsengClassifier
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Class GinsengClassifier">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#method-_get_key" class="md-nav__link">
    <span class="md-ellipsis">
      
        Method _get_key
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#method-predict" class="md-nav__link">
    <span class="md-ellipsis">
      
        Method predict
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#method-loss" class="md-nav__link">
    <span class="md-ellipsis">
      
        Method loss
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#method-evaluate" class="md-nav__link">
    <span class="md-ellipsis">
      
        Method evaluate
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#function-nn_xavier_uniform" class="md-nav__link">
    <span class="md-ellipsis">
      
        Function nn_xavier_uniform
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#function-nn_init_linear" class="md-nav__link">
    <span class="md-ellipsis">
      
        Function nn_init_linear
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#function-nn_linear" class="md-nav__link">
    <span class="md-ellipsis">
      
        Function nn_linear
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#function-nn_dropout" class="md-nav__link">
    <span class="md-ellipsis">
      
        Function nn_dropout
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#function-nn_normalize" class="md-nav__link">
    <span class="md-ellipsis">
      
        Function nn_normalize
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#function-nn_annotate_init" class="md-nav__link">
    <span class="md-ellipsis">
      
        Function nn_annotate_init
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#function-nn_annotate" class="md-nav__link">
    <span class="md-ellipsis">
      
        Function nn_annotate
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#function-nn_annotate_loss" class="md-nav__link">
    <span class="md-ellipsis">
      
        Function nn_annotate_loss
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#function-nn_annotate_evaluate" class="md-nav__link">
    <span class="md-ellipsis">
      
        Function nn_annotate_evaluate
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#file-modelpredictpy" class="md-nav__link">
    <span class="md-ellipsis">
      
        File: model/predict.py
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="File: model&#x2f;predict.py">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#function-_get_gene_indices" class="md-nav__link">
    <span class="md-ellipsis">
      
        Function _get_gene_indices
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#function-annotate_iter" class="md-nav__link">
    <span class="md-ellipsis">
      
        Function annotate_iter
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#function-classify" class="md-nav__link">
    <span class="md-ellipsis">
      
        Function classify
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#file-modelstatepy" class="md-nav__link">
    <span class="md-ellipsis">
      
        File: model/state.py
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="File: model&#x2f;state.py">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#class-ginsengclassifierstate" class="md-nav__link">
    <span class="md-ellipsis">
      
        Class GinsengClassifierState
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#function-classifier_from_state" class="md-nav__link">
    <span class="md-ellipsis">
      
        Function classifier_from_state
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#function-state_from_classifier_trainer" class="md-nav__link">
    <span class="md-ellipsis">
      
        Function state_from_classifier_trainer
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#file-trainaugmentpy" class="md-nav__link">
    <span class="md-ellipsis">
      
        File: train/augment.py
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="File: train&#x2f;augment.py">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#function-augment_mask" class="md-nav__link">
    <span class="md-ellipsis">
      
        Function augment_mask
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#function-augment_background" class="md-nav__link">
    <span class="md-ellipsis">
      
        Function augment_background
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#function-augment_dropgene" class="md-nav__link">
    <span class="md-ellipsis">
      
        Function augment_dropgene
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#function-augment" class="md-nav__link">
    <span class="md-ellipsis">
      
        Function augment
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#file-trainloggerpy" class="md-nav__link">
    <span class="md-ellipsis">
      
        File: train/logger.py
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="File: train&#x2f;logger.py">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#class-ginsenglogger" class="md-nav__link">
    <span class="md-ellipsis">
      
        Class GinsengLogger
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Class GinsengLogger">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#method-update" class="md-nav__link">
    <span class="md-ellipsis">
      
        Method update
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#method-report" class="md-nav__link">
    <span class="md-ellipsis">
      
        Method report
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#file-trainoptpy" class="md-nav__link">
    <span class="md-ellipsis">
      
        File: train/opt.py
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="File: train&#x2f;opt.py">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#class-adamstate" class="md-nav__link">
    <span class="md-ellipsis">
      
        Class AdamState
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#function-opt_init_adam" class="md-nav__link">
    <span class="md-ellipsis">
      
        Function opt_init_adam
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#function-opt_adam_update" class="md-nav__link">
    <span class="md-ellipsis">
      
        Function opt_adam_update
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#file-traintrainerpy" class="md-nav__link">
    <span class="md-ellipsis">
      
        File: train/trainer.py
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="File: train&#x2f;trainer.py">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#class-ginsengclassifiertrainersettings" class="md-nav__link">
    <span class="md-ellipsis">
      
        Class GinsengClassifierTrainerSettings
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#class-ginsengclassifiertrainer" class="md-nav__link">
    <span class="md-ellipsis">
      
        Class GinsengClassifierTrainer
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Class GinsengClassifierTrainer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#method-_train_step" class="md-nav__link">
    <span class="md-ellipsis">
      
        Method _train_step
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#method-fit" class="md-nav__link">
    <span class="md-ellipsis">
      
        Method fit
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#method-_run_epoch" class="md-nav__link">
    <span class="md-ellipsis">
      
        Method _run_epoch
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#method-_validate" class="md-nav__link">
    <span class="md-ellipsis">
      
        Method _validate
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#file-utilshvgpy" class="md-nav__link">
    <span class="md-ellipsis">
      
        File: utils/hvg.py
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="File: utils&#x2f;hvg.py">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#function-select_hvgs" class="md-nav__link">
    <span class="md-ellipsis">
      
        Function select_hvgs
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--secondary" aria-label="On this page">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      On this page
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#table-of-contents" class="md-nav__link">
    <span class="md-ellipsis">
      
        Table of Contents
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#file-datadatasetpy" class="md-nav__link">
    <span class="md-ellipsis">
      
        File: data/dataset.py
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="File: data&#x2f;dataset.py">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#class-ginsengdataset" class="md-nav__link">
    <span class="md-ellipsis">
      
        Class GinsengDataset
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Class GinsengDataset">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#method-_load_metadata" class="md-nav__link">
    <span class="md-ellipsis">
      
        Method _load_metadata
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#method-create" class="md-nav__link">
    <span class="md-ellipsis">
      
        Method create
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#method-make_split" class="md-nav__link">
    <span class="md-ellipsis">
      
        Method make_split
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#method-stream" class="md-nav__link">
    <span class="md-ellipsis">
      
        Method stream
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#file-dataiopy" class="md-nav__link">
    <span class="md-ellipsis">
      
        File: data/io.py
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="File: data&#x2f;io.py">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#function-read_10x_mtx" class="md-nav__link">
    <span class="md-ellipsis">
      
        Function read_10x_mtx
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#function-read_10x_h5" class="md-nav__link">
    <span class="md-ellipsis">
      
        Function read_10x_h5
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#function-read_adata" class="md-nav__link">
    <span class="md-ellipsis">
      
        Function read_adata
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#function-_load_pytree" class="md-nav__link">
    <span class="md-ellipsis">
      
        Function _load_pytree
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#function-save_model" class="md-nav__link">
    <span class="md-ellipsis">
      
        Function save_model
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#function-_save_pytree" class="md-nav__link">
    <span class="md-ellipsis">
      
        Function _save_pytree
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#function-load_model" class="md-nav__link">
    <span class="md-ellipsis">
      
        Function load_model
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#file-modelnnpy" class="md-nav__link">
    <span class="md-ellipsis">
      
        File: model/nn.py
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="File: model&#x2f;nn.py">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#class-ginsengclassifier" class="md-nav__link">
    <span class="md-ellipsis">
      
        Class GinsengClassifier
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Class GinsengClassifier">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#method-_get_key" class="md-nav__link">
    <span class="md-ellipsis">
      
        Method _get_key
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#method-predict" class="md-nav__link">
    <span class="md-ellipsis">
      
        Method predict
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#method-loss" class="md-nav__link">
    <span class="md-ellipsis">
      
        Method loss
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#method-evaluate" class="md-nav__link">
    <span class="md-ellipsis">
      
        Method evaluate
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#function-nn_xavier_uniform" class="md-nav__link">
    <span class="md-ellipsis">
      
        Function nn_xavier_uniform
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#function-nn_init_linear" class="md-nav__link">
    <span class="md-ellipsis">
      
        Function nn_init_linear
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#function-nn_linear" class="md-nav__link">
    <span class="md-ellipsis">
      
        Function nn_linear
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#function-nn_dropout" class="md-nav__link">
    <span class="md-ellipsis">
      
        Function nn_dropout
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#function-nn_normalize" class="md-nav__link">
    <span class="md-ellipsis">
      
        Function nn_normalize
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#function-nn_annotate_init" class="md-nav__link">
    <span class="md-ellipsis">
      
        Function nn_annotate_init
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#function-nn_annotate" class="md-nav__link">
    <span class="md-ellipsis">
      
        Function nn_annotate
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#function-nn_annotate_loss" class="md-nav__link">
    <span class="md-ellipsis">
      
        Function nn_annotate_loss
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#function-nn_annotate_evaluate" class="md-nav__link">
    <span class="md-ellipsis">
      
        Function nn_annotate_evaluate
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#file-modelpredictpy" class="md-nav__link">
    <span class="md-ellipsis">
      
        File: model/predict.py
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="File: model&#x2f;predict.py">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#function-_get_gene_indices" class="md-nav__link">
    <span class="md-ellipsis">
      
        Function _get_gene_indices
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#function-annotate_iter" class="md-nav__link">
    <span class="md-ellipsis">
      
        Function annotate_iter
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#function-classify" class="md-nav__link">
    <span class="md-ellipsis">
      
        Function classify
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#file-modelstatepy" class="md-nav__link">
    <span class="md-ellipsis">
      
        File: model/state.py
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="File: model&#x2f;state.py">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#class-ginsengclassifierstate" class="md-nav__link">
    <span class="md-ellipsis">
      
        Class GinsengClassifierState
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#function-classifier_from_state" class="md-nav__link">
    <span class="md-ellipsis">
      
        Function classifier_from_state
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#function-state_from_classifier_trainer" class="md-nav__link">
    <span class="md-ellipsis">
      
        Function state_from_classifier_trainer
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#file-trainaugmentpy" class="md-nav__link">
    <span class="md-ellipsis">
      
        File: train/augment.py
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="File: train&#x2f;augment.py">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#function-augment_mask" class="md-nav__link">
    <span class="md-ellipsis">
      
        Function augment_mask
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#function-augment_background" class="md-nav__link">
    <span class="md-ellipsis">
      
        Function augment_background
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#function-augment_dropgene" class="md-nav__link">
    <span class="md-ellipsis">
      
        Function augment_dropgene
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#function-augment" class="md-nav__link">
    <span class="md-ellipsis">
      
        Function augment
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#file-trainloggerpy" class="md-nav__link">
    <span class="md-ellipsis">
      
        File: train/logger.py
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="File: train&#x2f;logger.py">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#class-ginsenglogger" class="md-nav__link">
    <span class="md-ellipsis">
      
        Class GinsengLogger
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Class GinsengLogger">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#method-update" class="md-nav__link">
    <span class="md-ellipsis">
      
        Method update
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#method-report" class="md-nav__link">
    <span class="md-ellipsis">
      
        Method report
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#file-trainoptpy" class="md-nav__link">
    <span class="md-ellipsis">
      
        File: train/opt.py
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="File: train&#x2f;opt.py">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#class-adamstate" class="md-nav__link">
    <span class="md-ellipsis">
      
        Class AdamState
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#function-opt_init_adam" class="md-nav__link">
    <span class="md-ellipsis">
      
        Function opt_init_adam
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#function-opt_adam_update" class="md-nav__link">
    <span class="md-ellipsis">
      
        Function opt_adam_update
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#file-traintrainerpy" class="md-nav__link">
    <span class="md-ellipsis">
      
        File: train/trainer.py
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="File: train&#x2f;trainer.py">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#class-ginsengclassifiertrainersettings" class="md-nav__link">
    <span class="md-ellipsis">
      
        Class GinsengClassifierTrainerSettings
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#class-ginsengclassifiertrainer" class="md-nav__link">
    <span class="md-ellipsis">
      
        Class GinsengClassifierTrainer
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Class GinsengClassifierTrainer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#method-_train_step" class="md-nav__link">
    <span class="md-ellipsis">
      
        Method _train_step
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#method-fit" class="md-nav__link">
    <span class="md-ellipsis">
      
        Method fit
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#method-_run_epoch" class="md-nav__link">
    <span class="md-ellipsis">
      
        Method _run_epoch
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#method-_validate" class="md-nav__link">
    <span class="md-ellipsis">
      
        Method _validate
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#file-utilshvgpy" class="md-nav__link">
    <span class="md-ellipsis">
      
        File: utils/hvg.py
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="File: utils&#x2f;hvg.py">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#function-select_hvgs" class="md-nav__link">
    <span class="md-ellipsis">
      
        Function select_hvgs
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  
  
  


<h1 id="api-reference">API Reference</h1>
<h2 id="table-of-contents">Table of Contents</h2>
<ul>
<li><a href="#datadatasetpy">data/dataset.py</a><ul>
<li><a href="#class-ginsengdataset">Class: GinsengDataset</a><ul>
<li><a href="#method--load-metadata">Method: _load_metadata</a></li>
<li><a href="#method-create">Method: create</a></li>
<li><a href="#method-make-split">Method: make_split</a></li>
<li><a href="#method-stream">Method: stream</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#dataiopy">data/io.py</a><ul>
<li><a href="#function-read-10x-mtx">Function: read_10x_mtx</a></li>
<li><a href="#function-read-10x-h5">Function: read_10x_h5</a></li>
<li><a href="#function-read-adata">Function: read_adata</a></li>
<li><a href="#function--load-pytree">Function: _load_pytree</a></li>
<li><a href="#function-save-model">Function: save_model</a></li>
<li><a href="#function--save-pytree">Function: _save_pytree</a></li>
<li><a href="#function-load-model">Function: load_model</a></li>
</ul>
</li>
<li><a href="#modelnnpy">model/nn.py</a><ul>
<li><a href="#class-ginsengclassifier">Class: GinsengClassifier</a><ul>
<li><a href="#method--get-key">Method: _get_key</a></li>
<li><a href="#method-predict">Method: predict</a></li>
<li><a href="#method-loss">Method: loss</a></li>
<li><a href="#method-evaluate">Method: evaluate</a></li>
</ul>
</li>
<li><a href="#function-nn-xavier-uniform">Function: nn_xavier_uniform</a></li>
<li><a href="#function-nn-init-linear">Function: nn_init_linear</a></li>
<li><a href="#function-nn-linear">Function: nn_linear</a></li>
<li><a href="#function-nn-dropout">Function: nn_dropout</a></li>
<li><a href="#function-nn-normalize">Function: nn_normalize</a></li>
<li><a href="#function-nn-annotate-init">Function: nn_annotate_init</a></li>
<li><a href="#function-nn-annotate">Function: nn_annotate</a></li>
<li><a href="#function-nn-annotate-loss">Function: nn_annotate_loss</a></li>
<li><a href="#function-nn-annotate-evaluate">Function: nn_annotate_evaluate</a></li>
</ul>
</li>
<li><a href="#modelpredictpy">model/predict.py</a><ul>
<li><a href="#function--get-gene-indices">Function: _get_gene_indices</a></li>
<li><a href="#function-annotate-iter">Function: annotate_iter</a></li>
<li><a href="#function-classify">Function: classify</a></li>
</ul>
</li>
<li><a href="#modelstatepy">model/state.py</a><ul>
<li><a href="#class-ginsengclassifierstate">Class: GinsengClassifierState</a></li>
<li><a href="#function-classifier-from-state">Function: classifier_from_state</a></li>
<li><a href="#function-state-from-classifier-trainer">Function: state_from_classifier_trainer</a></li>
</ul>
</li>
<li><a href="#trainaugmentpy">train/augment.py</a><ul>
<li><a href="#function-augment-mask">Function: augment_mask</a></li>
<li><a href="#function-augment-background">Function: augment_background</a></li>
<li><a href="#function-augment-dropgene">Function: augment_dropgene</a></li>
<li><a href="#function-augment">Function: augment</a></li>
</ul>
</li>
<li><a href="#trainloggerpy">train/logger.py</a><ul>
<li><a href="#class-ginsenglogger">Class: GinsengLogger</a><ul>
<li><a href="#method-update">Method: update</a></li>
<li><a href="#method-report">Method: report</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#trainoptpy">train/opt.py</a><ul>
<li><a href="#class-adamstate">Class: AdamState</a></li>
<li><a href="#function-opt-init-adam">Function: opt_init_adam</a></li>
<li><a href="#function-opt-adam-update">Function: opt_adam_update</a></li>
</ul>
</li>
<li><a href="#traintrainerpy">train/trainer.py</a><ul>
<li><a href="#class-ginsengclassifiertrainersettings">Class: GinsengClassifierTrainerSettings</a></li>
<li><a href="#class-ginsengclassifiertrainer">Class: GinsengClassifierTrainer</a><ul>
<li><a href="#method--train-step">Method: _train_step</a></li>
<li><a href="#method-fit">Method: fit</a></li>
<li><a href="#method--run-epoch">Method: _run_epoch</a></li>
<li><a href="#method--validate">Method: _validate</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#utilshvgpy">utils/hvg.py</a><ul>
<li><a href="#function-select-hvgs">Function: select_hvgs</a></li>
</ul>
</li>
</ul>
<hr />
<h2 id="file-datadatasetpy"><a name="datadatasetpy"></a>File: <code>data/dataset.py</code></h2>
<h3 id="class-ginsengdataset"><a name="class-ginsengdataset"></a>Class <code>GinsengDataset</code></h3>
<p>An on-disk dataset for training single-cell classifiers.</p>
<p><strong>Attributes:</strong></p>
<ul>
<li><strong>path</strong> (<code>Path</code>): Path to the zarr dataset on disk.</li>
<li><strong>root</strong> (<code>zarr.Group</code>): The root zarr group object.</li>
<li><strong>n_cells</strong> (<code>int</code>): Total number of cells (observations) in the dataset.</li>
<li><strong>n_genes</strong> (<code>int</code>): Total number of genes (variables) in the dataset.</li>
<li><strong>label_names</strong> (<code>list of str</code>): Human-readable names for the integer labels.</li>
<li><strong>gene_names</strong> (<code>list of str</code>): Names of the genes stored in the dataset.</li>
<li><strong>labels</strong> (<code>np.ndarray</code>): Integer labels for every cell in the dataset.</li>
<li><strong>groups</strong> (<code>np.ndarray or None</code>): Categorical group indices (e.g., batch or donor) if provided.</li>
<li><strong>train_idx</strong> (<code>np.ndarray or None</code>): Indices of cells assigned to the training split.</li>
<li><strong>test_idx</strong> (<code>np.ndarray or None</code>): Indices of cells assigned to the test split.</li>
</ul>
<h4 id="method-_load_metadata"><a name="method--load-metadata"></a>Method <code>_load_metadata</code></h4>
<p>Load metadata and small arrays into memory.</p>
<h4 id="method-create"><a name="method-create"></a>Method <code>create</code></h4>
<p>Create a GinsengDataset from an AnnData object or file path.</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><strong>path</strong> (<code>str | Path</code>): Output path where the zarr dataset directory will be created.</li>
<li><strong>adata</strong> (<code>str | Path | ad.AnnData</code>): Input data. Can be an AnnData object, a local path to a (.h5ad, .h5, or 10x directory), or a URL to a supported file format.</li>
<li><strong>label_key</strong> (<code>str</code>): The column name in <code>adata.obs</code> containing the target labels (e.g., cell type).</li>
<li><strong>layer</strong> (<code>str, optional</code>): The key in <code>adata.layers</code> to use for expression counts. If None, uses <code>adata.X</code> (default : None).</li>
<li><strong>genes</strong> (<code>str | list of str | np.ndarray, optional</code>): Gene selection/filtering logic. - If a string: Assumes it is a column in <code>adata.var</code> containing a boolean mask (e.g., "highly_variable"). - If a list or array: A specific set of gene names to keep. This will also reorder the output to match the provided list. - If None: Keeps all genes (default : None).</li>
<li><strong>group_key</strong> (<code>str, optional</code>): The column name in <code>adata.obs</code> containing grouping metadata, such as "batch" or "donor" (default : None).</li>
<li><strong>chunk_size</strong> (<code>int</code>): Number of rows (cells) per zarr chunk for the expression matrix. Larger chunks improve compression but require more RAM during streaming (default : 4096).</li>
<li><strong>overwrite</strong> (<code>bool</code>): Whether to delete the existing directory at <code>path</code> if it exists (default : True).</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li><code>GinsengDataset</code>: An initialized instance of the dataset pointing to the new zarr store.</li>
</ul>
<h4 id="method-make_split"><a name="method-make-split"></a>Method <code>make_split</code></h4>
<p>Create train/test splits and store indices on disk.</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><strong>fraction</strong> (<code>float</code>): The proportion of data (or groups) to include in the test split. Must be in the range [0.0, 1.0) (default : 0.1).</li>
<li><strong>stratify_group</strong> (<code>bool</code>): If True, splits by groups (e.g., donors) rather than individual cells. Requires group_key to have been provided during creation (default : False).</li>
<li><strong>seed</strong> (<code>int</code>): Random seed for reproducibility (default : 123).</li>
</ul>
<h4 id="method-stream"><a name="method-stream"></a>Method <code>stream</code></h4>
<p>Stream mini-batches of (expression, label) from the zarr store.</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><strong>batch_size</strong> (<code>int</code>): Number of cells to yield in each batch.</li>
<li><strong>split</strong> (<code>Literal["train", "test", "all"]</code>): Which data split to stream from (default : "train").</li>
<li><strong>balance_labels</strong> (<code>bool</code>): If True, downsamples the training split to match the frequency of the least common class (default : False).</li>
<li><strong>shuffle</strong> (<code>bool</code>): Whether to shuffle the indices before streaming (default : True).  Yields ------</li>
<li><strong>X</strong> (<code>np.ndarray</code>): Expression matrix batch of shape (batch_size, n_genes).</li>
<li><strong>y</strong> (<code>np.ndarray</code>): Integer labels batch of shape (batch_size,).</li>
</ul>
<h2 id="file-dataiopy"><a name="dataiopy"></a>File: <code>data/io.py</code></h2>
<h3 id="function-read_10x_mtx"><a name="function-read-10x-mtx"></a>Function <code>read_10x_mtx</code></h3>
<p>Read 10x Genomics mtx format into an AnnData object.</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><strong>path</strong> (<code>str</code>): Path to directory containing matrix.mtx, barcodes.tsv, and genes.tsv/features.tsv.</li>
<li><strong>var_names</strong> (<code>str</code>): Select 'gene_symbols' or 'gene_ids' as index for var.</li>
<li><strong>make_unique</strong> (<code>bool</code>): If True, make var_names unique.</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li><code>AnnData</code>: </li>
</ul>
<h3 id="function-read_10x_h5"><a name="function-read-10x-h5"></a>Function <code>read_10x_h5</code></h3>
<p>Read 10x Genomics h5 format into an AnnData object.</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><strong>path</strong> (<code>str</code>): Path to 10x Genomics .h5 file.</li>
<li><strong>genome</strong> (<code>str, optional</code>): Genome to extract (if file contains multiple genomes). If None, will use the first genome available.</li>
<li><strong>var_names</strong> (<code>str</code>): Select 'gene_symbols' or 'gene_ids' as index for var.</li>
<li><strong>make_unique</strong> (<code>bool</code>): If True, make var_names unique.</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li><code>AnnData</code>: </li>
</ul>
<h3 id="function-read_adata"><a name="function-read-adata"></a>Function <code>read_adata</code></h3>
<p>Read an AnnData object from various supported file formats.</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><strong>path</strong> (<code>str | Path</code>): Path to the input count data stored in 10x .h5 format, AnnData .h5ad format, or in a 10x matrix market format folder.</li>
<li><strong>backed</strong> (<code>bool</code>): If True and the input is an <code>.h5ad</code> file, open the file in backed mode.</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li><code>AnnData</code>: The loaded AnnData object containing gene expression data.</li>
</ul>
<h3 id="function-_load_pytree"><a name="function--load-pytree"></a>Function <code>_load_pytree</code></h3>
<p>Recursively load a PyTree from an HDF5 group.</p>
<h3 id="function-save_model"><a name="function-save-model"></a>Function <code>save_model</code></h3>
<p>Save a Ginseng model state to a single HDF5 file.</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><strong>state</strong> (<code>GinsengClassifierState</code>): Complete model state to save.</li>
<li><strong>path</strong> (<code>str | Path</code>): Path to the output HDF5 file (will add .h5 if not present).</li>
</ul>
<p><strong>Examples:</strong></p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="c1"># After training</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">state</span> <span class="o">=</span> <span class="n">GinsengClassifierState</span><span class="p">(</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="o">...</span>     <span class="n">params</span><span class="o">=</span><span class="n">model</span><span class="o">.</span><span class="n">params</span><span class="p">,</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="o">...</span>     <span class="n">genes</span><span class="o">=</span><span class="n">dataset</span><span class="o">.</span><span class="n">gene_names</span><span class="p">,</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="o">...</span>     <span class="n">label_keys</span><span class="o">=</span><span class="n">dataset</span><span class="o">.</span><span class="n">label_names</span><span class="p">,</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="o">...</span>     <span class="n">label_values</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">dataset</span><span class="o">.</span><span class="n">label_names</span><span class="p">)),</span>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="o">...</span>     <span class="n">n_genes</span><span class="o">=</span><span class="n">dataset</span><span class="o">.</span><span class="n">n_genes</span><span class="p">,</span>
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="o">...</span>     <span class="n">n_classes</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">dataset</span><span class="o">.</span><span class="n">label_names</span><span class="p">),</span>
</span><span id="__span-0-9"><a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="o">...</span>     <span class="n">hidden_dim</span><span class="o">=</span><span class="mi">256</span><span class="p">,</span>
</span><span id="__span-0-10"><a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="o">...</span>     <span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="__span-0-11"><a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="o">...</span>     <span class="n">target_sum</span><span class="o">=</span><span class="mf">1e4</span><span class="p">,</span>
</span><span id="__span-0-12"><a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a><span class="o">...</span>     <span class="n">dropout_rate</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
</span><span id="__span-0-13"><a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a><span class="o">...</span>     <span class="n">training</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="__span-0-14"><a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a><span class="o">...</span> <span class="p">)</span>
</span><span id="__span-0-15"><a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">save_model</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="s2">&quot;./models/my_classifier.h5&quot;</span><span class="p">)</span>
</span></code></pre></div>
<h3 id="function-_save_pytree"><a name="function--save-pytree"></a>Function <code>_save_pytree</code></h3>
<p>Recursively save a PyTree to an HDF5 group.</p>
<h3 id="function-load_model"><a name="function-load-model"></a>Function <code>load_model</code></h3>
<p>Load a Ginseng model state from an HDF5 file.</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><strong>path</strong> (<code>str | Path</code>): Path to the HDF5 file.</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li><code>GinsengClassifierState</code>: Complete model state ready for inference or continued training.</li>
</ul>
<p><strong>Examples:</strong></p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">state</span> <span class="o">=</span> <span class="n">load_model</span><span class="p">(</span><span class="s2">&quot;./models/my_classifier.h5&quot;</span><span class="p">)</span>
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="o">&gt;&gt;&gt;</span>
</span><span id="__span-1-3"><a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a><span class="o">&gt;&gt;&gt;</span> <span class="c1"># Recreate model</span>
</span><span id="__span-1-4"><a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">model</span> <span class="o">=</span> <span class="n">GinsengClassifier</span><span class="p">(</span>
</span><span id="__span-1-5"><a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a><span class="o">...</span>     <span class="n">n_genes</span><span class="o">=</span><span class="n">state</span><span class="o">.</span><span class="n">n_genes</span><span class="p">,</span>
</span><span id="__span-1-6"><a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a><span class="o">...</span>     <span class="n">n_classes</span><span class="o">=</span><span class="n">state</span><span class="o">.</span><span class="n">n_classes</span><span class="p">,</span>
</span><span id="__span-1-7"><a id="__codelineno-1-7" name="__codelineno-1-7" href="#__codelineno-1-7"></a><span class="o">...</span>     <span class="n">hidden_dim</span><span class="o">=</span><span class="n">state</span><span class="o">.</span><span class="n">hidden_dim</span><span class="p">,</span>
</span><span id="__span-1-8"><a id="__codelineno-1-8" name="__codelineno-1-8" href="#__codelineno-1-8"></a><span class="o">...</span>     <span class="n">dropout_rate</span><span class="o">=</span><span class="n">state</span><span class="o">.</span><span class="n">dropout_rate</span><span class="p">,</span>
</span><span id="__span-1-9"><a id="__codelineno-1-9" name="__codelineno-1-9" href="#__codelineno-1-9"></a><span class="o">...</span>     <span class="n">normalize</span><span class="o">=</span><span class="n">state</span><span class="o">.</span><span class="n">normalize</span><span class="p">,</span>
</span><span id="__span-1-10"><a id="__codelineno-1-10" name="__codelineno-1-10" href="#__codelineno-1-10"></a><span class="o">...</span>     <span class="n">target_sum</span><span class="o">=</span><span class="n">state</span><span class="o">.</span><span class="n">target_sum</span><span class="p">,</span>
</span><span id="__span-1-11"><a id="__codelineno-1-11" name="__codelineno-1-11" href="#__codelineno-1-11"></a><span class="o">...</span> <span class="p">)</span>
</span><span id="__span-1-12"><a id="__codelineno-1-12" name="__codelineno-1-12" href="#__codelineno-1-12"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">model</span><span class="o">.</span><span class="n">params</span> <span class="o">=</span> <span class="n">state</span><span class="o">.</span><span class="n">params</span>
</span><span id="__span-1-13"><a id="__codelineno-1-13" name="__codelineno-1-13" href="#__codelineno-1-13"></a><span class="o">&gt;&gt;&gt;</span>
</span><span id="__span-1-14"><a id="__codelineno-1-14" name="__codelineno-1-14" href="#__codelineno-1-14"></a><span class="o">&gt;&gt;&gt;</span> <span class="c1"># Prepare new data with correct gene order</span>
</span><span id="__span-1-15"><a id="__codelineno-1-15" name="__codelineno-1-15" href="#__codelineno-1-15"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">new_data_ordered</span> <span class="o">=</span> <span class="n">new_data</span><span class="p">[</span><span class="n">state</span><span class="o">.</span><span class="n">genes</span><span class="p">]</span>
</span><span id="__span-1-16"><a id="__codelineno-1-16" name="__codelineno-1-16" href="#__codelineno-1-16"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">predictions</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">new_data_ordered</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">training</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span></code></pre></div>
<h2 id="file-modelnnpy"><a name="modelnnpy"></a>File: <code>model/nn.py</code></h2>
<h3 id="class-ginsengclassifier"><a name="class-ginsengclassifier"></a>Class <code>GinsengClassifier</code></h3>
<p>Wrapper class for cell type annotation with automatic key management.</p>
<p><strong>Attributes:</strong></p>
<ul>
<li><strong>n_genes</strong> (<code>int</code>): Number of genes in input data.</li>
<li><strong>n_classes</strong> (<code>int</code>): Number of cell type classes.</li>
<li><strong>hidden_dim</strong> (<code>int</code>): Hidden dimension for attention mechanism (default: 256).</li>
<li><strong>dropout_rate</strong> (<code>float</code>): Dropout rate during training (default: 0.5).</li>
<li><strong>normalize</strong> (<code>bool</code>): Whether to normalize input data (default: True).</li>
<li><strong>target_sum</strong> (<code>None | float</code>): Target sum for normalization (default: 1e4).</li>
<li><strong>seed</strong> (<code>int</code>): Random seed for reproducibility (default: 42).</li>
</ul>
<p><strong>Examples:</strong></p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">model</span> <span class="o">=</span> <span class="n">GinsengClassifier</span><span class="p">(</span><span class="n">n_genes</span><span class="o">=</span><span class="mi">2000</span><span class="p">,</span> <span class="n">n_classes</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</span><span id="__span-2-2"><a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a><span class="o">&gt;&gt;&gt;</span> <span class="c1"># During training (JAX-compatible)</span>
</span><span id="__span-2-3"><a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">loss</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">loss</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">params</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">_get_key</span><span class="p">(),</span> <span class="n">x_batch</span><span class="p">,</span> <span class="n">y_batch</span><span class="p">)</span>
</span><span id="__span-2-4"><a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a><span class="o">&gt;&gt;&gt;</span> <span class="c1"># For prediction (Standard usage)</span>
</span><span id="__span-2-5"><a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">logits</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x_test</span><span class="p">,</span> <span class="n">training</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span></code></pre></div>
<h4 id="method-_get_key"><a name="method--get-key"></a>Method <code>_get_key</code></h4>
<p>Get a new PRNG key and update internal state.</p>
<p><strong>Returns:</strong></p>
<ul>
<li><code>Array</code>: A new JAX PRNG key.</li>
</ul>
<h4 id="method-predict"><a name="method-predict"></a>Method <code>predict</code></h4>
<p>Generate predictions for input data.</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><strong>x</strong> (<code>Array</code>): Input gene expression matrix.</li>
<li><strong>params</strong> (<code>PyTree, optional</code>): Model parameters. If None, uses internal self.params.</li>
<li><strong>key</strong> (<code>Array, optional</code>): PRNG key. If None, uses a new key from self._get_key().</li>
<li><strong>training</strong> (<code>bool</code>): Whether to use training mode (with dropout).</li>
<li><strong>return_attn</strong> (<code>bool</code>): Whether to return attention weights.</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li><code>Array or tuple</code>: Logits, or (logits, attention) if return_attn=True.</li>
</ul>
<h4 id="method-loss"><a name="method-loss"></a>Method <code>loss</code></h4>
<p>Compute cross-entropy loss for a batch.</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><strong>params</strong> (<code>PyTree</code>): Model parameters to differentiate against.</li>
<li><strong>key</strong> (<code>Array</code>): PRNG key for dropout randomness.</li>
<li><strong>x</strong> (<code>Array</code>): Input gene expression matrix.</li>
<li><strong>y</strong> (<code>Array</code>): True class labels.</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li><code>Array</code>: Scalar loss value.</li>
</ul>
<h4 id="method-evaluate"><a name="method-evaluate"></a>Method <code>evaluate</code></h4>
<p>Evaluate model on a batch and return loss and accuracy.</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><strong>x</strong> (<code>Array</code>): Input gene expression matrix.</li>
<li><strong>y</strong> (<code>Array</code>): True class labels.</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li><code>tuple[float, float]</code>: (loss, accuracy) on the batch.</li>
</ul>
<h3 id="function-nn_xavier_uniform"><a name="function-nn-xavier-uniform"></a>Function <code>nn_xavier_uniform</code></h3>
<p>Initialize weights with Xavier uniform distribution.</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><strong>key</strong> (<code>Array</code>): PRNG key array for random number generation.</li>
<li><strong>shape</strong> (<code>tuple of int</code>): Shape of the weight matrix.</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li><code>Array</code>: Initialized weight matrix.</li>
</ul>
<h3 id="function-nn_init_linear"><a name="function-nn-init-linear"></a>Function <code>nn_init_linear</code></h3>
<p>Initialize parameters for a linear layer.</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><strong>key</strong> (<code>Array</code>): PRNG key array for random initialization.</li>
<li><strong>in_dim</strong> (<code>int</code>): Input dimension.</li>
<li><strong>out_dim</strong> (<code>int</code>): Output dimension.</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li><code>PyTree[Float[Array, "..."]]</code>: Dictionary with weight matrix <code>W</code> and bias vector <code>b</code>.</li>
</ul>
<h3 id="function-nn_linear"><a name="function-nn-linear"></a>Function <code>nn_linear</code></h3>
<p>Apply a linear transformation.</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><strong>params</strong> (<code>PyTree[Float[Array, "..."]]</code>): Layer parameters with <code>W</code> and <code>b</code>.</li>
<li><strong>x</strong> (<code>Array</code>): Input tensor.</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li><code>Array</code>: Transformed output tensor.</li>
</ul>
<h3 id="function-nn_dropout"><a name="function-nn-dropout"></a>Function <code>nn_dropout</code></h3>
<p>Apply dropout to input array with optimized implementation.</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><strong>key</strong> (<code>Array</code>): PRNG key array for dropout mask.</li>
<li><strong>x</strong> (<code>Array</code>): Input tensor.</li>
<li><strong>rate</strong> (<code>float</code>): Dropout probability.</li>
<li><strong>training</strong> (<code>bool</code>): If True, apply dropout. Set to False for deterministic output after training.</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li><code>Array</code>: Tensor with dropout applied.</li>
</ul>
<h3 id="function-nn_normalize"><a name="function-nn-normalize"></a>Function <code>nn_normalize</code></h3>
<p>Normalize counts per cell and apply log transform.</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><strong>x</strong> (<code>Array</code>): Count matrix.</li>
<li><strong>target_sum</strong> (<code>float</code>): Target total count per cell after normalization.</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li><code>Array</code>: Normalized expression matrix.</li>
</ul>
<h3 id="function-nn_annotate_init"><a name="function-nn-annotate-init"></a>Function <code>nn_annotate_init</code></h3>
<p>Initialize parameters for the cell type annotation network.</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><strong>key</strong> (<code>Array</code>): PRNG key array for random initialization.</li>
<li><strong>n_genes</strong> (<code>int</code>): Number of genes.</li>
<li><strong>n_classes</strong> (<code>int</code>): Number of classes.</li>
<li><strong>hidden_dim</strong> (<code>int</code>): Dimension of hidden layers for attention mechanism.</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li><code>PyTree[Float[Array, "..."]]</code>: Dictionary of initialized model parameters.</li>
</ul>
<h3 id="function-nn_annotate"><a name="function-nn-annotate"></a>Function <code>nn_annotate</code></h3>
<p>Annotate cells using instance-based attention neural network.</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><strong>params</strong> (<code>PyTree[Float[Array, "..."]]</code>): Model parameters from <code>nn_annotate_init</code>.</li>
<li><strong>key</strong> (<code>Array</code>): PRNG key array for random number generation.</li>
<li><strong>x</strong> (<code>Array</code>): Input gene expression matrix (batch_size, n_genes).</li>
<li><strong>dropout_rate</strong> (<code>float</code>): Dropout probability (default: 0.5).</li>
<li><strong>normalize</strong> (<code>bool</code>): If True, normalize and log-transform counts (default: True).</li>
<li><strong>target_sum</strong> (<code>None | float</code>): Target total count per cell after normalization (default: 1e4).</li>
<li><strong>return_attn</strong> (<code>bool</code>): If True, also return attention weights (default: False).</li>
<li><strong>training</strong> (<code>bool</code>): Whether the model is in training mode (default: True).</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li><code>Float[Array, ...] | tuple[Float[Array, ...], Float[Array, ...]]</code>: Logits for each class. If <code>return_attn=True</code>, gene-level attention weights are also returned as second element.</li>
</ul>
<h3 id="function-nn_annotate_loss"><a name="function-nn-annotate-loss"></a>Function <code>nn_annotate_loss</code></h3>
<p>Cross-entropy loss for cell type annotation model.</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><strong>params</strong> (<code>PyTree[Float[Array, "..."]]</code>): Model parameters from <code>nn_annotate_init</code>.</li>
<li><strong>key</strong> (<code>Array</code>): PRNG key array for random number generation.</li>
<li><strong>x</strong> (<code>Array</code>): Input gene expression matrix (batch_size, n_genes).</li>
<li><strong>y</strong> (<code>Array</code>): True cell type labels as integer class indices (batch_size,).</li>
<li><strong>dropout_rate</strong> (<code>float</code>): Dropout probability (default: 0.5).</li>
<li><strong>normalize</strong> (<code>bool</code>): If True, normalize and log-transform counts (default: True).</li>
<li><strong>target_sum</strong> (<code>None | float</code>): Target total count per cell after normalization. Defaults to 1e4 (standard for scRNA-seq).</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li><code>Float[Array, ""]</code>: Scalar cross-entropy loss.</li>
</ul>
<h3 id="function-nn_annotate_evaluate"><a name="function-nn-annotate-evaluate"></a>Function <code>nn_annotate_evaluate</code></h3>
<p>Evaluate model performance on a batch.</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><strong>params</strong> (<code>PyTree[Float[Array, "..."]]</code>): Model parameters from <code>nn_annotate_init</code>.</li>
<li><strong>key</strong> (<code>Array</code>): PRNG key array for random number generation.</li>
<li><strong>x</strong> (<code>Array</code>): Input gene expression matrix (batch_size, n_genes).</li>
<li><strong>y</strong> (<code>Array</code>): True cell type labels as integer class indices (batch_size,).</li>
<li><strong>dropout_rate</strong> (<code>float</code>): Dropout probability (default: 0.5).</li>
<li><strong>normalize</strong> (<code>bool</code>): If True, normalize and log-transform counts (default: True).</li>
<li><strong>target_sum</strong> (<code>None | float</code>): Target total count per cell after normalization. Defaults to 1e4 (standard for scRNA-seq).</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li><code>tuple[Float[Array, ""], Int[Array, ""], Int[Array, ""]]</code>: Tuple of (loss, total_samples, correct_predictions).</li>
</ul>
<h2 id="file-modelpredictpy"><a name="modelpredictpy"></a>File: <code>model/predict.py</code></h2>
<h3 id="function-_get_gene_indices"><a name="function--get-gene-indices"></a>Function <code>_get_gene_indices</code></h3>
<p>Map model gene names to indices within the AnnData object.</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><strong>adata</strong> (<code>AnnData</code>): The single-cell data object.</li>
<li><strong>gene_names</strong> (<code>np.ndarray</code>): Array of gene names expected by the model in a specific order.</li>
<li><strong>gene_key</strong> (<code>str | None</code>): Column name in <code>adata.var</code> containing gene names. If None, uses <code>adata.var_names</code>.</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li><code>available_idx</code>: np.ndarray The integer indices of genes found in <code>adata</code> that match the model's expected genes. out_positions : np.ndarray The corresponding positions in the model's input vector where these genes belong.</li>
</ul>
<h3 id="function-annotate_iter"><a name="function-annotate-iter"></a>Function <code>annotate_iter</code></h3>
<p>Batch iterator that handles gene reordering and zero-padding for missing genes.</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><strong>adata</strong> (<code>AnnData</code>): The single-cell data object.</li>
<li><strong>gene_names</strong> (<code>np.ndarray</code>): Ordered gene names from the trained model.</li>
<li><strong>gene_key</strong> (<code>str | None</code>): Column in <code>adata.var</code> to use for gene matching.</li>
<li><strong>layer</strong> (<code>str | None</code>): Key in <code>adata.layers</code> to use for counts. If None, uses <code>adata.X</code>.</li>
<li><strong>batch_size</strong> (<code>int</code>): Number of cells to process per batch.  Yields ------</li>
<li><strong>batch_tensor</strong> (<code>jax.numpy.ndarray</code>): A JAX-compatible array of shape (batch_size, n_model_genes).</li>
<li><strong>start</strong> (<code>int</code>): Starting observation index.</li>
<li><strong>end</strong> (<code>int</code>): Ending observation index.</li>
</ul>
<h3 id="function-classify"><a name="function-classify"></a>Function <code>classify</code></h3>
<p>Annotate single-cell sequencing data using a trained ginseng classifier.</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><strong>model_state</strong> (<code>GinsengClassifierState | str | Path</code>): A loaded GinsengClassifierState or a path to a saved state file.</li>
<li><strong>adata</strong> (<code>AnnData | str | Path</code>): AnnData object or path to count data (.h5ad, .h5, or Matrix Market).</li>
<li><strong>gene_key</strong> (<code>str | None</code>): Column in <code>.var</code> containing gene names. If None, uses index.</li>
<li><strong>layer</strong> (<code>str | None</code>): Key in <code>adata.layers</code> to use for counts. If None, uses <code>adata.X</code>.</li>
<li><strong>backed</strong> (<code>bool</code>): If True and <code>adata</code> is a path, reads data in backed mode.</li>
<li><strong>normalize</strong> (<code>bool | None</code>): Override model normalization setting.</li>
<li><strong>target_sum</strong> (<code>float | None</code>): Override model target sum.</li>
<li><strong>randomness</strong> (<code>bool</code>): If True, enables dropout during inference.</li>
<li><strong>batch_size</strong> (<code>int</code>): Number of cells to process in each forward pass.</li>
<li><strong>copy</strong> (<code>bool</code>): If True, returns a modified copy of the AnnData object.</li>
<li><strong>store_probs</strong> (<code>bool</code>): If True, stores the full probability matrix in <code>adata.obsm</code>.</li>
<li><strong>return_table</strong> (<code>bool</code>): If True, returns a pandas DataFrame instead of modifying AnnData.</li>
<li><strong>seed</strong> (<code>int</code>): Random seed.</li>
<li><strong>silent</strong> (<code>bool</code>): If True, suppresses progress bar and warnings.</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li><code>AnnData | pd.DataFrame | None</code>: Returns a DataFrame if <code>return_table</code> is True, a copy of AnnData if <code>copy</code> is True, otherwise modifies in-place and returns None.</li>
</ul>
<h2 id="file-modelstatepy"><a name="modelstatepy"></a>File: <code>model/state.py</code></h2>
<h3 id="class-ginsengclassifierstate"><a name="class-ginsengclassifierstate"></a>Class <code>GinsengClassifierState</code></h3>
<p>Complete state of a trained Ginseng model.</p>
<p>All information needed to save, load, and use a trained model.</p>
<p><strong>Attributes:</strong></p>
<ul>
<li><strong>params</strong> (<code>PyTree</code>): Model parameters (weights and biases).</li>
<li><strong>genes</strong> (<code>np.ndarray</code>): Gene names in the exact order expected by the model.</li>
<li><strong>label_keys</strong> (<code>np.ndarray</code>): Label names (e.g., ['T-cell', 'B-cell', 'Macrophage']).</li>
<li><strong>label_values</strong> (<code>np.ndarray</code>): Integer values corresponding to each label (e.g., [0, 1, 2]).</li>
<li><strong>n_genes</strong> (<code>int</code>): Number of genes.</li>
<li><strong>n_classes</strong> (<code>int</code>): Number of classes.</li>
<li><strong>hidden_dim</strong> (<code>int</code>): Hidden dimension used in attention mechanism.</li>
<li><strong>normalize</strong> (<code>bool</code>): Whether input data should be normalized.</li>
<li><strong>target_sum</strong> (<code>float</code>): Target sum for normalization.</li>
<li><strong>dropout_rate</strong> (<code>float</code>): Dropout rate used during training.</li>
<li><strong>training</strong> (<code>bool</code>): Whether weights should be frozen (False after training).</li>
</ul>
<h3 id="function-classifier_from_state"><a name="function-classifier-from-state"></a>Function <code>classifier_from_state</code></h3>
<p>Create a GinsengClassifier from a loaded state.</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><strong>state</strong> (<code>GinsengClassifierState</code>): Loaded model state.</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li><code>GinsengClassifier</code>: Model ready for inference.</li>
</ul>
<h3 id="function-state_from_classifier_trainer"><a name="function-state-from-classifier-trainer"></a>Function <code>state_from_classifier_trainer</code></h3>
<p>Create a GinsengClassifierState from a trainer after .fit().</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><strong>trainer</strong> (<code>GinsengClassifierTrainer</code>): Trainer instance with a trained model.</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li><code>GinsengClassifierState</code>: Complete model state.</li>
</ul>
<p><strong>Examples:</strong></p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">trainer</span> <span class="o">=</span> <span class="n">GinsengClassifierTrainer</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span> <span class="n">settings</span><span class="p">)</span>
</span><span id="__span-3-2"><a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">trainer</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">epochs</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
</span><span id="__span-3-3"><a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">state</span> <span class="o">=</span> <span class="n">state_from_trainer</span><span class="p">(</span><span class="n">trainer</span><span class="p">)</span>
</span><span id="__span-3-4"><a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">save_model</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="s2">&quot;./models/my_classifier.h5&quot;</span><span class="p">)</span>
</span></code></pre></div>
<h2 id="file-trainaugmentpy"><a name="trainaugmentpy"></a>File: <code>train/augment.py</code></h2>
<h3 id="function-augment_mask"><a name="function-augment-mask"></a>Function <code>augment_mask</code></h3>
<p>Randomly mask out counts across cells.</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><strong>key</strong> (<code>Array</code>): PRNG key array for dropout mask.</li>
<li><strong>x</strong> (<code>Array</code>): Input tensor.</li>
<li><strong>rate</strong> (<code>float</code>): Dropout probability.</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li><code>Array</code>: Tensor with dropout applied.</li>
</ul>
<h3 id="function-augment_background"><a name="function-augment-background"></a>Function <code>augment_background</code></h3>
<p>Randomly add Poisson-distributed background noise to counts.</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><strong>key</strong> (<code>Array</code>): PRNG key array for noise generation.</li>
<li><strong>x</strong> (<code>Array</code>): Non-normalized count matrix.</li>
<li><strong>lam_max</strong> (<code>float</code>): Maximum mean of Poisson distribution for sampling added noise.</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li><code>Array</code>: Counts with added Poisson noise.</li>
</ul>
<h3 id="function-augment_dropgene"><a name="function-augment-dropgene"></a>Function <code>augment_dropgene</code></h3>
<p>Randomly zero out entire genes.</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><strong>key</strong> (<code>Array</code>): PRNG key array for mask generation.</li>
<li><strong>x</strong> (<code>Array</code>): Count matrix.</li>
<li><strong>lower</strong> (<code>int</code>): Minimum number of genes to mask out.</li>
<li><strong>upper</strong> (<code>int</code>): Maximum (exclusive) number of genes to mask out.</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li><code>Array</code>: Filtered counts.</li>
</ul>
<h3 id="function-augment"><a name="function-augment"></a>Function <code>augment</code></h3>
<p>Apply a combination of single-cell RNA relevant augmentations.</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><strong>key</strong> (<code>Array</code>): PRNG key array for mask generation.</li>
<li><strong>x</strong> (<code>Array</code>): Count matrix.</li>
<li><strong>rate</strong> (<code>float</code>): Dropout probability.</li>
<li><strong>lam_max</strong> (<code>float</code>): Maximum mean of Poisson distribution for sampling added noise.</li>
<li><strong>lower</strong> (<code>int</code>): Minimum number of genes to mask out.</li>
<li><strong>upper</strong> (<code>int</code>): Maximum (exclusive) number of genes to mask out.</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li><code>Array</code>: Augmented counts.</li>
</ul>
<h2 id="file-trainloggerpy"><a name="trainloggerpy"></a>File: <code>train/logger.py</code></h2>
<h3 id="class-ginsenglogger"><a name="class-ginsenglogger"></a>Class <code>GinsengLogger</code></h3>
<p>Logger for storing training and validation metrics across epochs.</p>
<p><strong>Attributes:</strong></p>
<ul>
<li><strong>epoch</strong> (<code>list[int]</code>): List of epoch indices.</li>
<li><strong>train_loss</strong> (<code>list[float]</code>): Training loss values for each epoch.</li>
<li><strong>holdout_loss</strong> (<code>list[float]</code>): Holdout loss values for each epoch.</li>
<li><strong>holdout_accuracy</strong> (<code>list[float]</code>): Holdout accuracy values for each epoch.</li>
</ul>
<h4 id="method-update"><a name="method-update"></a>Method <code>update</code></h4>
<p>Update the logger with new training and validation metrics.</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><strong>epoch</strong> (<code>int</code>): Current epoch index.</li>
<li><strong>train_loss</strong> (<code>float</code>): Training loss at this epoch.</li>
<li><strong>holdout_loss</strong> (<code>float</code>): Validation loss at this epoch.</li>
<li><strong>holdout_accuracy</strong> (<code>float</code>): Validation accuracy at this epoch.</li>
</ul>
<h4 id="method-report"><a name="method-report"></a>Method <code>report</code></h4>
<p>Print most recent result to standard output.</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><strong>silent</strong> (<code>bool</code>): If True, suppresses report output.</li>
<li><strong>flush</strong> (<code>bool</code>): If True, write report to output immediately.</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li><code>None</code>: Output is printed to standard output.</li>
</ul>
<h2 id="file-trainoptpy"><a name="trainoptpy"></a>File: <code>train/opt.py</code></h2>
<h3 id="class-adamstate"><a name="class-adamstate"></a>Class <code>AdamState</code></h3>
<p>State for the Adam optimizer.</p>
<p><strong>Attributes:</strong></p>
<ul>
<li><strong>step</strong> (<code>int</code>): Current optimization step.</li>
<li><strong>m</strong> (<code>PyTree of Array</code>): Exponential moving average of gradients.</li>
<li><strong>v</strong> (<code>PyTree of Array</code>): Exponential moving average of squared gradients.</li>
</ul>
<h3 id="function-opt_init_adam"><a name="function-opt-init-adam"></a>Function <code>opt_init_adam</code></h3>
<p>Initialize Adam optimizer state.</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><strong>params</strong> (<code>PyTree[Float[Array, ...]]</code>): Model parameters to be optimized.</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li><code>AdamState</code>: Initial optimizer state with zeroed moments.</li>
</ul>
<h3 id="function-opt_adam_update"><a name="function-opt-adam-update"></a>Function <code>opt_adam_update</code></h3>
<p>Perform one Adam optimization step.</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><strong>grads</strong> (<code>PyTree[Float[Array, ...]]</code>): Gradients of the loss w.r.t. parameters.</li>
<li><strong>params</strong> (<code>PyTree[Float[Array, ...]]</code>): Current model parameters.</li>
<li><strong>state</strong> (<code>AdamState</code>): Current optimizer state.</li>
<li><strong>lr</strong> (<code>float</code>): Learning rate.</li>
<li><strong>betas</strong> (<code>tuple[float, float]</code>): Exponential decay rates for first and second moment estimates.</li>
<li><strong>eps</strong> (<code>float</code>): Numerical stability constant.</li>
<li><strong>weight_decay</strong> (<code>float</code>): L2 regularization factor.</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li><code>tuple</code>: Updated parameters and new optimizer state.</li>
</ul>
<h2 id="file-traintrainerpy"><a name="traintrainerpy"></a>File: <code>train/trainer.py</code></h2>
<h3 id="class-ginsengclassifiertrainersettings"><a name="class-ginsengclassifiertrainersettings"></a>Class <code>GinsengClassifierTrainerSettings</code></h3>
<p>Training configuration settings for <code>GinsengClassifierTrainer</code>.</p>
<h3 id="class-ginsengclassifiertrainer"><a name="class-ginsengclassifiertrainer"></a>Class <code>GinsengClassifierTrainer</code></h3>
<p>Trainer class for orchestrating the training of a GinsengClassifier.</p>
<h4 id="method-_train_step"><a name="method--train-step"></a>Method <code>_train_step</code></h4>
<p>Internal training step to update parameters.</p>
<h4 id="method-fit"><a name="method-fit"></a>Method <code>fit</code></h4>
<p>Execute the training loop.</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><strong>epochs</strong> (<code>int</code>): Number of training epochs to run (default : 10).</li>
<li><strong>silent</strong> (<code>bool</code>): If True, suppresses training progress output (default : False).</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li><code>GinsengClassifier</code>: The trained classifier with updated parameters.</li>
</ul>
<h4 id="method-_run_epoch"><a name="method--run-epoch"></a>Method <code>_run_epoch</code></h4>
<p>Run a single training epoch.</p>
<h4 id="method-_validate"><a name="method--validate"></a>Method <code>_validate</code></h4>
<p>Run validation on the holdout split.</p>
<h2 id="file-utilshvgpy"><a name="utilshvgpy"></a>File: <code>utils/hvg.py</code></h2>
<h3 id="function-select_hvgs"><a name="function-select-hvgs"></a>Function <code>select_hvgs</code></h3>
<p>Select highly variable genes from raw or normalized counts.</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><strong>adata</strong> (<code>AnnData</code>): AnnData object with gene names stored in <code>var</code>.</li>
<li><strong>n_top_genes</strong> (<code>int</code>): Number of top highly variable genes to select.</li>
<li><strong>layer</strong> (<code>str, optional</code>): Key in <code>adata.layers</code> to use. If None, uses <code>adata.X</code>.</li>
<li><strong>target_sum</strong> (<code>float, optional</code>): If provided, scales each cell to this sum and applies log1p transformation (default: 1e4).</li>
<li><strong>min_mean</strong> (<code>float</code>): Lower quantile bound on mean gene expression.</li>
<li><strong>max_mean</strong> (<code>float</code>): Upper quantile bound on mean gene expression.</li>
<li><strong>n_bins</strong> (<code>int</code>): Select genes across this many gene expression bins.</li>
<li><strong>chunk_size</strong> (<code>int</code>): Number of cells to process in memory at once.</li>
<li><strong>silent</strong> (<code>bool</code>): If True, suppresses progress bar.</li>
<li><strong>copy</strong> (<code>bool</code>): If True, returns a copy of the AnnData.</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li><code>Optional[AnnData]</code>: Marks highly variable genes in <code>var['ginseng_genes']</code>.</li>
</ul>














                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2025 Tom W. Ouellette 

    </div>
  
  
    Made with
    <a href="https://zensical.org/" target="_blank" rel="noopener">
      Zensical
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      
      <script id="__config" type="application/json">{"annotate":null,"base":"..","features":["navigation.expand"],"search":"../assets/javascripts/workers/search.5e1f2129.min.js","tags":null,"translations":{"clipboard.copied":"Copied to clipboard","clipboard.copy":"Copy to clipboard","search.result.more.one":"1 more on this page","search.result.more.other":"# more on this page","search.result.none":"No matching documents","search.result.one":"1 matching document","search.result.other":"# matching documents","search.result.placeholder":"Type to start searching","search.result.term.missing":"Missing","select.version":"Select version"},"version":null}</script>
    
    
      <script src="../assets/javascripts/bundle.1193bd74.min.js"></script>
      
        <script src="../javascripts/mathjax.js"></script>
      
        <script src="https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>